using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using System.Collections.Generic;
using System.Linq;

var builder = WebApplication.CreateBuilder(args);
builder.Services.AddControllers();
builder.Services.AddSingleton<LibraryService>();
var app = builder.Build();

app.UseRouting();

app.UseEndpoints(endpoints =>
{
    endpoints.MapControllers();
});

app.Run();

public class LibraryService
{
    private readonly List<string> _entries = new();
    
    public void AddEntry(string entry)
    {
        _entries.Add(entry);
    }
    
    public IEnumerable<string> GetEntries()
    {
        return _entries;
    }
}

[ApiController]
[Route("api/library")]
public class LibraryController : ControllerBase
{
    private readonly LibraryService _libraryService;
    
    public LibraryController(LibraryService libraryService)
    {
        _libraryService = libraryService;
    }
    
    [HttpPost("add")]
    public IActionResult AddEntry([FromBody] string entry)
    {
        _libraryService.AddEntry(entry);
        return Ok(new { message = "Entry added successfully." });
    }
    
    [HttpGet("entries")]
    public IActionResult GetEntries()
    {
        return Ok(_libraryService.GetEntries());
    }
}
